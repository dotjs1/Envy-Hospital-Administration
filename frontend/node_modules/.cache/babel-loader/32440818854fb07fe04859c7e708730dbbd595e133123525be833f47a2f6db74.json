{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{ToastContainer,toast}from\"react-toastify\";import\"react-toastify/dist/ReactToastify.css\";import\"bootstrap-icons/font/bootstrap-icons.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AppointmentTable=()=>{const[appointments,setAppointments]=useState([]);const[search,setSearch]=useState(\"\");const[loading,setLoading]=useState(true);// loading state added\nuseEffect(()=>{fetch(\" https://envy-hospital-backend.onrender.com/api/user/getappointment\").then(res=>res.json()).then(data=>{setAppointments(data.data||[]);setLoading(false);// loading complete\n}).catch(err=>{console.error(err);setLoading(false);//  stop spinner on error\n});},[]);const cancelAppointment=async id=>{if(!window.confirm(\"Are you sure you want to cancel this appointment?\"))return;try{const res=await fetch(`http://localhost:3001/api/user/cancel?id=${id}`,{method:\"DELETE\"});const data=await res.json();if(res.ok){toast.success(data.message);setAppointments(prev=>prev.filter(a=>a._id!==id));}else{toast.error(data.error);}}catch(err){toast.error(\"Error cancelling appointment\");}};const filtered=appointments.filter(a=>`${a.ptname} ${a.doctorname} ${a.ptemail}`.toLowerCase().includes(search.toLowerCase()));return/*#__PURE__*/_jsxs(\"div\",{className:\"card p-4 shadow-lg rounded-4\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center mb-4 fw-bold text-primary\",children:\"Appointment Details\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"input-group-text bg-light\",children:/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-search\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Search by name, doctor, or email...\",value:search,onChange:e=>setSearch(e.target.value)})]}),/*#__PURE__*/_jsx(\"div\",{className:\"table-responsive\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"table table-hover align-middle\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"table-primary text-center\",children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Patient\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Doctor\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Date\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Action\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:loading?/*#__PURE__*/// ðŸ”„ Spinner while loading\n_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{colSpan:\"6\",className:\"text-center py-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner-border text-primary\",role:\"status\",children:/*#__PURE__*/_jsx(\"span\",{className:\"visually-hidden\",children:\"Loading...\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2\",children:\"Fetching appointments, please wait...\"})]})}):filtered.length>0?filtered.map(a=>/*#__PURE__*/_jsxs(\"tr\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"fw-semibold\",children:a.ptname}),/*#__PURE__*/_jsx(\"td\",{children:a.doctorname}),/*#__PURE__*/_jsx(\"td\",{children:a.ptemail}),/*#__PURE__*/_jsx(\"td\",{children:new Date(a.dateofappointment).toLocaleDateString()}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"badge bg-success\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-check-circle me-1\"}),\"Confirmed\"]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-sm btn-outline-danger\",onClick:()=>cancelAppointment(a._id),children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-x-circle me-1\"}),\"Cancel\"]})})]},a._id)):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsxs(\"td\",{colSpan:\"6\",className:\"text-center text-muted py-4\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"bi bi-calendar-x fs-4\"}),/*#__PURE__*/_jsx(\"br\",{}),\"No appointments found.\"]})})})]})}),/*#__PURE__*/_jsx(ToastContainer,{})]});};export default AppointmentTable;","map":{"version":3,"names":["React","useEffect","useState","ToastContainer","toast","jsx","_jsx","jsxs","_jsxs","AppointmentTable","appointments","setAppointments","search","setSearch","loading","setLoading","fetch","then","res","json","data","catch","err","console","error","cancelAppointment","id","window","confirm","method","ok","success","message","prev","filter","a","_id","filtered","ptname","doctorname","ptemail","toLowerCase","includes","className","children","type","placeholder","value","onChange","e","target","colSpan","role","length","map","Date","dateofappointment","toLocaleDateString","onClick"],"sources":["C:/Users/ACER/Envy Hospital (Admin)react.js/frontend/src/components/AppointmentTable.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { ToastContainer, toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport \"bootstrap-icons/font/bootstrap-icons.css\";\r\nconst AppointmentTable = () => {\r\n  const [appointments, setAppointments] = useState([]);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [loading, setLoading] = useState(true); // loading state added\r\n\r\n  useEffect(() => {\r\n    fetch(\" https://envy-hospital-backend.onrender.com/api/user/getappointment\")\r\n      .then((res) => res.json())\r\n      .then((data) => {\r\n        setAppointments(data.data || []);\r\n        setLoading(false); // loading complete\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n        setLoading(false); //  stop spinner on error\r\n      });\r\n  }, []);\r\n\r\n  const cancelAppointment = async (id) => {\r\n    if (!window.confirm(\"Are you sure you want to cancel this appointment?\")) return;\r\n    try {\r\n      const res = await fetch(`http://localhost:3001/api/user/cancel?id=${id}`, {\r\n        method: \"DELETE\",\r\n      });\r\n      const data = await res.json();\r\n      if (res.ok) {\r\n        toast.success(data.message);\r\n        setAppointments((prev) => prev.filter((a) => a._id !== id));\r\n      } else {\r\n        toast.error(data.error);\r\n      }\r\n    } catch (err) {\r\n      toast.error(\"Error cancelling appointment\");\r\n    }\r\n  };\r\n\r\n  const filtered = appointments.filter((a) =>\r\n    `${a.ptname} ${a.doctorname} ${a.ptemail}`.toLowerCase().includes(search.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div className=\"card p-4 shadow-lg rounded-4\">\r\n      <h2 className=\"text-center mb-4 fw-bold text-primary\">Appointment Details</h2>\r\n\r\n      <div className=\"input-group mb-4\">\r\n        <span className=\"input-group-text bg-light\"><i className=\"bi bi-search\"></i></span>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-control\"\r\n          placeholder=\"Search by name, doctor, or email...\"\r\n          value={search}\r\n          onChange={(e) => setSearch(e.target.value)}\r\n        />\r\n      </div>\r\n\r\n      <div className=\"table-responsive\">\r\n        <table className=\"table table-hover align-middle\">\r\n          <thead className=\"table-primary text-center\">\r\n            <tr>\r\n              <th>Patient</th>\r\n              <th>Doctor</th>\r\n              <th>Email</th>\r\n              <th>Date</th>\r\n              <th>Status</th>\r\n              <th>Action</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {loading ? ( // ðŸ”„ Spinner while loading\r\n              <tr>\r\n                <td colSpan=\"6\" className=\"text-center py-5\">\r\n                  <div className=\"spinner-border text-primary\" role=\"status\">\r\n                    <span className=\"visually-hidden\">Loading...</span>\r\n                  </div>\r\n                  <div className=\"mt-2\">Fetching appointments, please wait...</div>\r\n                </td>\r\n              </tr>\r\n            ) : filtered.length > 0 ? (\r\n              filtered.map((a) => (\r\n                <tr key={a._id} className=\"text-center\">\r\n                  <td className=\"fw-semibold\">{a.ptname}</td>\r\n                  <td>{a.doctorname}</td>\r\n                  <td>{a.ptemail}</td>\r\n                  <td>{new Date(a.dateofappointment).toLocaleDateString()}</td>\r\n                  <td>\r\n                    <span className=\"badge bg-success\">\r\n                      <i className=\"bi bi-check-circle me-1\"></i>Confirmed\r\n                    </span>\r\n                  </td>\r\n                  <td>\r\n                    <button\r\n                      className=\"btn btn-sm btn-outline-danger\"\r\n                      onClick={() => cancelAppointment(a._id)}\r\n                    >\r\n                      <i className=\"bi bi-x-circle me-1\"></i>Cancel\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr>\r\n                <td colSpan=\"6\" className=\"text-center text-muted py-4\">\r\n                  <i className=\"bi bi-calendar-x fs-4\"></i><br />\r\n                  No appointments found.\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <ToastContainer />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AppointmentTable;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}